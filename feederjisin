javascript:(()=>{const API="https://api.p2pquake.net/v2/jma/quake?limit=1";const S={10:"1",20:"2",30:"3",40:"4",45:"5弱",50:"5強",55:"6弱",60:"6強",70:"7"};let lastId=null,last556=null;async function check(){try{const r=await fetch(API);if(!r.ok)return;const j=await r.json();if(!Array.isArray(j)||!j.length)return;const d=j[0];const id=d.id;if(id===lastId)return;const input=document.getElementById("post_form_single");const btn=document.getElementById("post_btn");if(!input||!btn)return;if(d.code===556){last556=id;lastId=id;const time=d.earthquake.time||"";const place=d.earthquake.hypocenter?.name||"不明";input.value=`${time}地震速報が発令されました${place}揺れに注意してください`;btn.click();return;}if(d.code===551&&last556!==null){lastId=id;const place=d.earthquake.hypocenter?.name||"不明";const scale=S[d.earthquake.maxScale]||"不明";const mag=d.earthquake.hypocenter?.magnitude||"不明";input.value=`地震の情報が入りました。震源地は ${place} です。地震の強さは 震度${scale} です。マグニチュードは ${mag}M です。以上みかんからお伝えしました。`;btn.click();last556=null;return;}if(d.code===552&&last556!==null){lastId=id;let major=[],warn=[],adv=[];if(Array.isArray(d.areas)){d.areas.forEach(a=>{if(a.grade==="MajorWarning")major.push(a.name);if(a.grade==="Warning")warn.push(a.name);if(a.grade==="Advisory")adv.push(a.name);});}input.value=`地震の情報です。津波が発令されました。発令されてる地域はこちらです。${major.length?"大津波警報\n"+major.join("\n")+"\n":""}${warn.length?"津波警報\n"+warn.join("\n")+"\n":""}${adv.length?"津波注意報\n"+adv.join("\n")+"\n":""}以上みかんからお伝えしました。`;btn.click();last556=null;return;}}catch(e){}}setInterval(check,15000);})();
